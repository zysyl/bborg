# bborg
скрипт бекапа некоторых акакаунтов ispmgr через borg

## рекомендации
желательно создать директорию /var/opt/borg/ и в нее скопипастить бинарник, после чего сделать на него линк в /usr/loca/bin/. В скрипте используется окружение BORG_BASE_DIR=/var/opt/borg, то есть в этой директории создаются вспомогательные директории с кешами и конфигурацией .cache .config. Для того что-бы использовать общий кеш для скрипта и пользователя, нужно под пользователем на котором запускается borg создать переменную окружения **export BORG_BASE_DIR=/var/opt/borg** и желательно добавить ее в .bashrc, .zshrc или какой там шел по умолчанию используется, что-бы после ребута либо создания новой сессии экспортировалась правильная переменная окружения.

Бекап делается без шифрования, потому для их хранения рекомендуется использовать свои сервера. Бекап делается через стандартный порт ssh, нужно заранее настроить авторизацию по ключу на сервер бекапа того пользователя, который используется для бекапа. Для каждого пользователя создается свой репозиторий с бекапом. Все параметры хранятся в файле borg.env который должен находится в той же директории что и скрипт. example.borg.env пример такого файла.

сервер на который делается бекап 

    BORG_SERVER=192.168.10.5

имя пользователя на сервере на котором делается бекап

    BORG_USER=myuser

имя папки в которой будут складываться бекапы в данном случае она будет /home/myuser/usersback

    BORG_SERVER_HOMEDIR=usersback

это папка где размещены пользовательские директории у разных хостинговых панелей они разный в ispmgr это /var/www/имяпользователя

    USERS_HOMEDIR=/var/www

список пользователей которые нужно бекапить, лично 

    USERS_LIST='anton ivan mark'

ящик на который пришлется общий репорт

    SEND_TO='borg@example.com'

тема письма

    SUBJ='borg report'

